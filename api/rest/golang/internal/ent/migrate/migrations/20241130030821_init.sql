-- Create "users" table
CREATE TABLE `users` (`id` bigint NOT NULL AUTO_INCREMENT, `uuid` char(36) NOT NULL, `email` varchar(255) NOT NULL, `username` varchar(255) NOT NULL, `password_digest` varchar(255) NOT NULL, `refresh_token` varchar(255) NOT NULL, `status` enum('active','deactive') NOT NULL DEFAULT "active", `created_at` timestamp NOT NULL, `updated_at` timestamp NOT NULL, PRIMARY KEY (`id`), UNIQUE INDEX `email` (`email`), UNIQUE INDEX `user_email` (`email`), INDEX `user_username` (`username`), UNIQUE INDEX `uuid` (`uuid`)) CHARSET utf8mb4 COLLATE utf8mb4_bin;
-- Create "projects" table
CREATE TABLE `projects` (`id` bigint NOT NULL AUTO_INCREMENT, `uuid` char(36) NOT NULL, `slug` varchar(255) NOT NULL, `name` varchar(255) NOT NULL, `user_id` bigint NOT NULL, `goal` longtext NOT NULL, `shouldbe` longtext NULL, `status` enum('initial','active','archived') NOT NULL DEFAULT "initial", `deadline` timestamp NOT NULL, `starting_at` timestamp NULL, `started_at` timestamp NULL, `finished_at` timestamp NULL, `archived_at` timestamp NULL, `created_at` timestamp NOT NULL, `updated_at` timestamp NOT NULL, `user_projects` bigint NULL, PRIMARY KEY (`id`), INDEX `project_deadline` (`deadline`), INDEX `project_user_id` (`user_id`), INDEX `projects_users_projects` (`user_projects`), UNIQUE INDEX `slug` (`slug`), UNIQUE INDEX `uuid` (`uuid`), CONSTRAINT `projects_users_projects` FOREIGN KEY (`user_projects`) REFERENCES `users` (`id`) ON UPDATE NO ACTION ON DELETE SET NULL) CHARSET utf8mb4 COLLATE utf8mb4_bin;
-- Create "tasks" table
CREATE TABLE `tasks` (`id` bigint NOT NULL AUTO_INCREMENT, `uuid` char(36) NOT NULL, `title` varchar(255) NOT NULL, `status` enum('initial','scheduled','completed','archived') NOT NULL DEFAULT "initial", `kind` enum('task','milestone') NOT NULL DEFAULT "task", `deadline` timestamp NOT NULL, `starting_at` timestamp NULL, `started_at` timestamp NULL, `finished_at` timestamp NULL, `archived_at` timestamp NULL, `created_at` timestamp NOT NULL, `updated_at` timestamp NOT NULL, `project_tasks` bigint NOT NULL, `project_milestones` bigint NOT NULL, `user_tasks` bigint NOT NULL, PRIMARY KEY (`id`), INDEX `tasks_projects_milestones` (`project_milestones`), INDEX `tasks_projects_tasks` (`project_tasks`), INDEX `tasks_users_tasks` (`user_tasks`), UNIQUE INDEX `title` (`title`), UNIQUE INDEX `uuid` (`uuid`), CONSTRAINT `tasks_projects_milestones` FOREIGN KEY (`project_milestones`) REFERENCES `projects` (`id`) ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT `tasks_projects_tasks` FOREIGN KEY (`project_tasks`) REFERENCES `projects` (`id`) ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT `tasks_users_tasks` FOREIGN KEY (`user_tasks`) REFERENCES `users` (`id`) ON UPDATE NO ACTION ON DELETE NO ACTION) CHARSET utf8mb4 COLLATE utf8mb4_bin;
